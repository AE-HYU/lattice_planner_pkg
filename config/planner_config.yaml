# Local Planner Configuration

local_planner:
  ros__parameters:
    # Reference path configuration
    # Available options in config/reference_paths/:
    # - "Spielberg_global"
    # - "slam_map_global" 
    # - "slamtoolbox_raceline"
    # - "first_map_raceline"
    # - "" (empty for default test path)
    # reference_path_file: "Spielberg_global"  # CSV filename without extension
    reference_path_file: "new_map1_2"  # CSV filename without extension

    path_resolution: 0.1
    
    # Planning parameters
    lateral_step: 0.28           # Lateral sampling step (m)
    max_lateral_offset: 1.5     # Maximum lateral offset (m)
    planning_horizon: 0.5       # Planning time horizon (s) - increased for better lookahead
    dt: 0.1                     # Time step (s)
    planning_frequency: 20.0    # Planning frequency (Hz)
    
    # Path smoothing parameters (to fix lattice deformation)
    min_planning_distance: 1.3   # Minimum planning distance (m) for better lookahead
    transition_smoothness: 2.0   # Transition smoothness factor (higher = smoother)
    curvature_weight: 0.5        # Weight for curvature continuity in cost function
    
    # Vehicle geometry for front-wheel planning
    wheelbase: 0.32              # Distance from rear to front axle (m)
    front_lookahead: 0.1         # Additional lookahead beyond front axle (m)
    
    # Vehicle parameters
    max_velocity: 8.0           # Maximum velocity (m/s)
    max_curvature: 0.892          # Maximum path curvature (1/m)
    vehicle_width: 0.35         # Vehicle width for collision checking (m)
    safety_margin: 0.3          # Safety margin from track boundaries (m) - increased from 0.2
    
    # Progressive lattice expansion parameters
    lattice_initial_width: 0.1       # Initial lateral offset near rear axle (m) - small for sparse near rear
    lattice_expansion_rate: 0.05     # How quickly lattices expand per meter forward
    lattice_expansion_distance: 8.0  # Distance over which to apply progressive expansion (m)
    
    # Speed control parameters (for obstacle avoidance)
    hazard_detection_distance: 3.0   # Distance at which to start reducing speed (m)
    min_hazard_distance: 0.5         # Distance at which maximum speed reduction occurs (m)
    min_speed_ratio: 0.6             # Minimum speed as fraction of reference speed (0.6 = 60%)
    speed_sigmoid_steepness: 2.0     # Steepness of sigmoid speed reduction curve (higher = more aggressive)